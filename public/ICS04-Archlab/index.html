<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ICS04 Archlab | H's Blog</title><meta name="author" content="Herbert"><meta name="copyright" content="Herbert"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Arch Lab的目的是加深对于Y86指令执行的理解。实验分城三个部分，Part A是完成三个程序的汇编代码，Part B要向已有的指令集中加入两条指令，Part C是优化代码，使其运行的尽可能快。 Part A 在sim&#x2F;misc文件夹中，我们要编写三个Y86指令汇编代码，实现examples.c中相应函数的功能。 sum.ys 先来看一下c的程序： 12345678910&#x2F;* sum_list">
<meta property="og:type" content="article">
<meta property="og:title" content="ICS04 Archlab">
<meta property="og:url" content="https://blog.zhuoyuan-he.cn/ICS04-Archlab/index.html">
<meta property="og:site_name" content="H&#39;s Blog">
<meta property="og:description" content="Arch Lab的目的是加深对于Y86指令执行的理解。实验分城三个部分，Part A是完成三个程序的汇编代码，Part B要向已有的指令集中加入两条指令，Part C是优化代码，使其运行的尽可能快。 Part A 在sim&#x2F;misc文件夹中，我们要编写三个Y86指令汇编代码，实现examples.c中相应函数的功能。 sum.ys 先来看一下c的程序： 12345678910&#x2F;* sum_list">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zhuoyuan-he.cn/linear-gradient(20deg,%20#0062be,%20#925696,%20#cc426e,%20#fb0347)">
<meta property="article:published_time" content="2023-02-07T13:20:54.000Z">
<meta property="article:modified_time" content="2023-04-02T04:19:42.959Z">
<meta property="article:author" content="Herbert">
<meta property="article:tag" content="ICS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zhuoyuan-he.cn/linear-gradient(20deg,%20#0062be,%20#925696,%20#cc426e,%20#fb0347)"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.zhuoyuan-he.cn/ICS04-Archlab/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ICS04 Archlab',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-02 12:19:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/selfie.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">H's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ICS04 Archlab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-07T13:20:54.000Z" title="发表于 2023-02-07 21:20:54">2023-02-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-02T04:19:42.959Z" title="更新于 2023-04-02 12:19:42">2023-04-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ICS04 Archlab"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Arch Lab的目的是加深对于Y86指令执行的理解。实验分城三个部分，Part A是完成三个程序的汇编代码，Part B要向已有的指令集中加入两条指令，Part C是优化代码，使其运行的尽可能快。</p>
<h2 id="Part-A">Part A</h2>
<p>在sim/misc文件夹中，我们要编写三个Y86指令汇编代码，实现examples.c中相应函数的功能。</p>
<h3 id="sum-ys"><code>sum.ys</code></h3>
<p>先来看一下c的程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* sum_list - Sum the elements of a linked list */</span></span><br><span class="line"><span class="type">long</span> <span class="title function_">sum_list</span><span class="params">(list_ptr ls)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">long</span> val = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ls) &#123;</span><br><span class="line">  val += ls-&gt;val;</span><br><span class="line">  ls = ls-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一个迭代求和的过程。实验材料并没有给出模板，但是可以参考教材图4-7给出的完整的程序文件的例子。这样的程序包括了数据和相应的所有指令。略微的区别在于书上是对一个数组进行求和，而lab要求对链表进行求和，所以要对取下一个数的方式做出修改，也就是先从当前节点拿到下一个节点的地址，然后得到下一个节点的数据。代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># Execution begins at address 0</span><br><span class="line">    .pos 0</span><br><span class="line">    irmovq stack, %rsp      # Set up stack pointer</span><br><span class="line">    call main       # Execute main program</span><br><span class="line">    halt            # Terminate program</span><br><span class="line"></span><br><span class="line"># sample linked list of 3 elements</span><br><span class="line">    .align 8</span><br><span class="line">ele1:</span><br><span class="line">    .quad 0x00a</span><br><span class="line">    .quad ele2</span><br><span class="line">ele2:</span><br><span class="line">    .quad 0x0b0</span><br><span class="line">    .quad ele3</span><br><span class="line">ele3:</span><br><span class="line">    .quad 0xc00</span><br><span class="line">    .quad 0</span><br><span class="line"></span><br><span class="line">main:</span><br><span class="line">    irmovq ele1,%rdi</span><br><span class="line">    call sum_list        # sum_list</span><br><span class="line">    ret</span><br><span class="line"></span><br><span class="line"># long sum_list(list_ptr ls)</span><br><span class="line"># start in %rdi</span><br><span class="line">sum_list:</span><br><span class="line">    xorq %rax,%rax       # sum = 0</span><br><span class="line">    pushq %r8</span><br><span class="line">L1:</span><br><span class="line">    andq %rdi,%rdi       # Set CC</span><br><span class="line">    je L2</span><br><span class="line">    mrmovq (%rdi),%r8</span><br><span class="line">    addq %r8,%rax</span><br><span class="line">    mrmovq 8(%rdi),%rdi</span><br><span class="line">    jmp L1</span><br><span class="line"></span><br><span class="line">L2:</span><br><span class="line">    popq %r8</span><br><span class="line">    ret</span><br><span class="line"></span><br><span class="line"># Stack starts here and grows to lower addresses</span><br><span class="line">    .pos 0x200</span><br><span class="line">stack:</span><br></pre></td></tr></table></figure>
<h3 id="rsum-ys"><code>rsum.ys</code></h3>
<p>先来看一下c的程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* rsum_list - Recursive version of sum_list */</span></span><br><span class="line"><span class="type">long</span> <span class="title function_">rsum_list</span><span class="params">(list_ptr ls)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!ls)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="type">long</span> val = ls-&gt;val;</span><br><span class="line">  <span class="type">long</span> rest = rsum_list(ls-&gt;next);</span><br><span class="line">  <span class="keyword">return</span> val + rest;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一个递归调用函数来求和的过程。程序的初始化，数据设置，main都和上一问一样，仅需改变求和的函数实现。在函数调用时，应保存好caller saved寄存器中的数据，将传递的参数放在rdi等寄存器中，同时注意被调用的函数要保存好callee saved寄存器中的值。代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># Execution begins at address 0</span><br><span class="line">    .pos 0</span><br><span class="line">    irmovq stack, %rsp      # Set up stack pointer</span><br><span class="line">    call main       # Execute main program</span><br><span class="line">    halt            # Terminate program</span><br><span class="line"></span><br><span class="line"># sample linked list of 3 elements</span><br><span class="line">    .align 8</span><br><span class="line">ele1:</span><br><span class="line">    .quad 0x00a</span><br><span class="line">    .quad ele2</span><br><span class="line">ele2:</span><br><span class="line">    .quad 0x0b0</span><br><span class="line">    .quad ele3</span><br><span class="line">ele3:</span><br><span class="line">    .quad 0xc00</span><br><span class="line">    .quad 0</span><br><span class="line"></span><br><span class="line">main:</span><br><span class="line">    irmovq ele1,%rdi</span><br><span class="line">    call rsum_list        # sum_list</span><br><span class="line">    ret</span><br><span class="line"></span><br><span class="line"># long sum_list(list_ptr ls)</span><br><span class="line"># ls in %rdi</span><br><span class="line">rsum_list:</span><br><span class="line">    andq %rdi,%rdi       # Set CC</span><br><span class="line">    je L2</span><br><span class="line">    pushq %r9</span><br><span class="line">    mrmovq (%rdi), %r9</span><br><span class="line">    mrmovq 8(%rdi), %rdi</span><br><span class="line">    call rsum_list</span><br><span class="line">    addq %r9,%rax</span><br><span class="line">    popq %r9</span><br><span class="line">    ret</span><br><span class="line">L2:</span><br><span class="line">    irmovq $0,%rax</span><br><span class="line">    ret</span><br><span class="line"></span><br><span class="line"># Stack starts here and grows to lower addresses</span><br><span class="line">    .pos 0x200</span><br><span class="line">stack:</span><br></pre></td></tr></table></figure>
<h3 id="bubble-ys"><code>bubble.ys</code></h3>
<p>先来看一下c的程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* bubble_sort - Sort long numbers at data in ascending order */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bubble_sort</span><span class="params">(<span class="type">long</span> *data, <span class="type">long</span> count)</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="type">long</span> *i, *last;</span><br><span class="line">     <span class="keyword">for</span>(last = data + count - <span class="number">1</span>; last &gt; data; last--) &#123;</span><br><span class="line">         <span class="keyword">for</span>(i = data; i &lt; last; i++) &#123;</span><br><span class="line">             <span class="keyword">if</span>(*(i + <span class="number">1</span>) &lt; *i) &#123;</span><br><span class="line">                 <span class="type">long</span> t = *(i + <span class="number">1</span>);</span><br><span class="line">                 *(i + <span class="number">1</span>) = *i;</span><br><span class="line">                 *i = t;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需要用冒泡排序的方式对六个数升序排列，并且放在原先的地址空间上。也就是说，只是在两个数要换顺序的时候交换相应地址中的数值。由于没有递归过程，只要想明白循环和判断在汇编中的实现，此题并不困难。代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"># Execution begins at address 0</span><br><span class="line">    .pos 0</span><br><span class="line">    irmovq stack, %rsp      # Set up stack pointer</span><br><span class="line">    call main       # Execute main program</span><br><span class="line">    halt            # Terminate program</span><br><span class="line"></span><br><span class="line"># sample linked list of 3 elements</span><br><span class="line">    .align 8</span><br><span class="line">Array:</span><br><span class="line">    .quad 0xbca</span><br><span class="line">    .quad 0xcba</span><br><span class="line">    .quad 0xacb</span><br><span class="line">    .quad 0xcab</span><br><span class="line">    .quad 0xabc</span><br><span class="line">    .quad 0xbac</span><br><span class="line"></span><br><span class="line">main:</span><br><span class="line">    irmovq Array,%rdi</span><br><span class="line">    irmovq $6,%rsi</span><br><span class="line">    call bubble_sort</span><br><span class="line">    ret</span><br><span class="line"></span><br><span class="line"># void bubble_sort(long *data, long count)</span><br><span class="line"># data in %rdi, count in %rsi</span><br><span class="line">bubble_sort:</span><br><span class="line">    pushq %r8</span><br><span class="line">    pushq %r9</span><br><span class="line">    pushq %r10</span><br><span class="line">    pushq %r11</span><br><span class="line">    pushq %r12</span><br><span class="line">    pushq %r13</span><br><span class="line">    pushq %r14</span><br><span class="line">    irmovq $8,%r8        # Constant 8</span><br><span class="line">    rrmovq %rdi,%r9    # last in %r9</span><br><span class="line">    addq %rsi,%rsi</span><br><span class="line">    addq %rsi,%rsi</span><br><span class="line">    addq %rsi,%rsi</span><br><span class="line">    subq %r8,%rsi</span><br><span class="line">    addq %rsi,%r9    # last = data + count - 1</span><br><span class="line">L1:</span><br><span class="line">    rrmovq %r9,%r10</span><br><span class="line">    subq %rdi,%r10</span><br><span class="line">    jle L2</span><br><span class="line">    rrmovq %rdi,%r11   # i in %r11</span><br><span class="line">L3:</span><br><span class="line">    rrmovq %r9,%r12</span><br><span class="line">    subq %r11,%r12</span><br><span class="line">    jle L4</span><br><span class="line">    mrmovq (%r11),%r12    # *i</span><br><span class="line">    mrmovq 8(%r11),%r13    # *(i+1)</span><br><span class="line">    rrmovq %r12,%r14</span><br><span class="line">    subq %r13,%r14</span><br><span class="line">    jle L5</span><br><span class="line">    rrmovq %r13,%r14</span><br><span class="line">    rmmovq %r12,8(%r11)</span><br><span class="line">    rmmovq %r14,(%r11)</span><br><span class="line">L5:</span><br><span class="line">    addq %r8,%r11   # i++</span><br><span class="line">    jmp L3</span><br><span class="line">L4:</span><br><span class="line">    subq %r8,%r9   # last--</span><br><span class="line">    jmp L1</span><br><span class="line">L2:</span><br><span class="line">    popq %r14</span><br><span class="line">    popq %r13</span><br><span class="line">    popq %r12</span><br><span class="line">    popq %r11</span><br><span class="line">    popq %r10</span><br><span class="line">    popq %r9</span><br><span class="line">    popq %r8</span><br><span class="line">    ret</span><br><span class="line"></span><br><span class="line"># Stack starts here and grows to lower addresses</span><br><span class="line">    .pos 0x200</span><br><span class="line">stack:</span><br></pre></td></tr></table></figure>
<h2 id="Part-B">Part B</h2>
<p>在这一部分中，我们需要seq-full.hcl文件，修改增加两条Y86指令。这里我非常建议详细阅读seq-full.hcl的所有内容，这不论是对于完成lab还是期中考试都有非常大的帮助。</p>
<p>首先，给出两条指令的描述，可以参考书本的示例。按照相应流水线阶段的过程写出相应的步骤并不困难，需要注意的一个是加法指令一定不要忘记设置状态码CC，另一个是ALU单元的两个操作数的顺序。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#              iaddq V, rB               </span><br><span class="line"># Fetch    icode:ifun &lt;- M1[PC]</span><br><span class="line">#          rA:rB &lt;- M1[PC+1]</span><br><span class="line">#          valC &lt;- M8[PC+2]</span><br><span class="line">#          valP &lt;- PC+10</span><br><span class="line"># Decode   valB &lt;- R[rB]</span><br><span class="line"># Excute   valE &lt;- valC + valB</span><br><span class="line">#          Set CC</span><br><span class="line"># Memory</span><br><span class="line"># Write    R[rB] &lt;- valE</span><br><span class="line"># PC       PC &lt;- valP      </span><br><span class="line">#</span><br><span class="line">#              jm V, rB               </span><br><span class="line"># Fetch    icode:ifun &lt;- M1[PC]</span><br><span class="line">#          rA:rB &lt;- M1[PC+1]</span><br><span class="line">#          valC &lt;- M8[PC+2]</span><br><span class="line">#          valP &lt;- PC+10</span><br><span class="line"># Decode   valB &lt;- R[rB]</span><br><span class="line"># Excute   valE &lt;- valC + valB</span><br><span class="line"># memory   valM &lt;- M8[valE]</span><br><span class="line"># Write    </span><br><span class="line"># PC       PC &lt;- valM</span><br></pre></td></tr></table></figure>
<p>然后在HCL文件相应的位置添加上两种指令相应的操作即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line">#/* $begin seq-all-hcl */</span><br><span class="line">####################################################################</span><br><span class="line">#  HCL Description of Control for Single Cycle Y86-64 Processor SEQ   #</span><br><span class="line">#  Copyright (C) Randal E. Bryant, David R. O&#x27;Hallaron, 2010       #</span><br><span class="line">####################################################################</span><br><span class="line"></span><br><span class="line">## Your task is to implement the iaddq instruction</span><br><span class="line">## The file contains a declaration of the icodes</span><br><span class="line">## for iaddq (IIADDQ)</span><br><span class="line">## Your job is to add the rest of the logic to make it work</span><br><span class="line"></span><br><span class="line">####################################################################</span><br><span class="line">#    C Include&#x27;s.  Don&#x27;t alter these                               #</span><br><span class="line">####################################################################</span><br><span class="line"></span><br><span class="line">quote &#x27;#include &lt;stdio.h&gt;&#x27;</span><br><span class="line">quote &#x27;#include &quot;isa.h&quot;&#x27;</span><br><span class="line">quote &#x27;#include &quot;sim.h&quot;&#x27;</span><br><span class="line">quote &#x27;int sim_main(int argc, char *argv[]);&#x27;</span><br><span class="line">quote &#x27;word_t gen_pc()&#123;return 0;&#125;&#x27;</span><br><span class="line">quote &#x27;int main(int argc, char *argv[])&#x27;</span><br><span class="line">quote &#x27;  &#123;plusmode=0;return sim_main(argc,argv);&#125;&#x27;</span><br><span class="line"></span><br><span class="line">####################################################################</span><br><span class="line">#    Declarations.  Do not change/remove/delete any of these       #</span><br><span class="line">####################################################################</span><br><span class="line"></span><br><span class="line">##### Symbolic representation of Y86-64 Instruction Codes #############</span><br><span class="line">wordsig INOP  &#x27;I_NOP&#x27;</span><br><span class="line">wordsig IHALT &#x27;I_HALT&#x27;</span><br><span class="line">wordsig IRRMOVQ &#x27;I_RRMOVQ&#x27;</span><br><span class="line">wordsig IIRMOVQ &#x27;I_IRMOVQ&#x27;</span><br><span class="line">wordsig IRMMOVQ &#x27;I_RMMOVQ&#x27;</span><br><span class="line">wordsig IMRMOVQ &#x27;I_MRMOVQ&#x27;</span><br><span class="line">wordsig IOPQ  &#x27;I_ALU&#x27;</span><br><span class="line">wordsig IJXX  &#x27;I_JMP&#x27;</span><br><span class="line">wordsig ICALL &#x27;I_CALL&#x27;</span><br><span class="line">wordsig IRET  &#x27;I_RET&#x27;</span><br><span class="line">wordsig IPUSHQ  &#x27;I_PUSHQ&#x27;</span><br><span class="line">wordsig IPOPQ &#x27;I_POPQ&#x27;</span><br><span class="line"># Instruction code for iaddq instruction</span><br><span class="line">wordsig IIADDQ  &#x27;I_IADDQ&#x27;</span><br><span class="line">#Instruction code for jm instruction</span><br><span class="line">wordsig IJM     &#x27;I_JM&#x27;</span><br><span class="line"></span><br><span class="line">##### Symbolic represenations of Y86-64 function codes                  #####</span><br><span class="line">wordsig FNONE    &#x27;F_NONE&#x27;        # Default function code</span><br><span class="line"></span><br><span class="line">##### Symbolic representation of Y86-64 Registers referenced explicitly #####</span><br><span class="line">wordsig RRSP     &#x27;REG_RSP&#x27;      # Stack Pointer</span><br><span class="line">wordsig RNONE    &#x27;REG_NONE&#x27;     # Special value indicating &quot;no register&quot;</span><br><span class="line"></span><br><span class="line">##### ALU Functions referenced explicitly                            #####</span><br><span class="line">wordsig ALUADD  &#x27;A_ADD&#x27;   # ALU should add its arguments</span><br><span class="line"></span><br><span class="line">##### Possible instruction status values                             #####</span><br><span class="line">wordsig SAOK  &#x27;STAT_AOK&#x27;  # Normal execution</span><br><span class="line">wordsig SADR  &#x27;STAT_ADR&#x27;  # Invalid memory address</span><br><span class="line">wordsig SINS  &#x27;STAT_INS&#x27;  # Invalid instruction</span><br><span class="line">wordsig SHLT  &#x27;STAT_HLT&#x27;  # Halt instruction encountered</span><br><span class="line"></span><br><span class="line">##### Signals that can be referenced by control logic ####################</span><br><span class="line"></span><br><span class="line">##### Fetch stage inputs    #####</span><br><span class="line">wordsig pc &#x27;pc&#x27;       # Program counter</span><br><span class="line">##### Fetch stage computations    #####</span><br><span class="line">wordsig imem_icode &#x27;imem_icode&#x27;   # icode field from instruction memory</span><br><span class="line">wordsig imem_ifun  &#x27;imem_ifun&#x27;    # ifun field from instruction memory</span><br><span class="line">wordsig icode   &#x27;icode&#x27;   # Instruction control code</span><br><span class="line">wordsig ifun    &#x27;ifun&#x27;    # Instruction function</span><br><span class="line">wordsig rA    &#x27;ra&#x27;      # rA field from instruction</span><br><span class="line">wordsig rB    &#x27;rb&#x27;      # rB field from instruction</span><br><span class="line">wordsig valC    &#x27;valc&#x27;    # Constant from instruction</span><br><span class="line">wordsig valP    &#x27;valp&#x27;    # Address of following instruction</span><br><span class="line">boolsig imem_error &#x27;imem_error&#x27;   # Error signal from instruction memory</span><br><span class="line">boolsig instr_valid &#x27;instr_valid&#x27; # Is fetched instruction valid?</span><br><span class="line"></span><br><span class="line">##### Decode stage computations   #####</span><br><span class="line">wordsig valA  &#x27;vala&#x27;      # Value from register A port</span><br><span class="line">wordsig valB  &#x27;valb&#x27;      # Value from register B port</span><br><span class="line"></span><br><span class="line">##### Execute stage computations  #####</span><br><span class="line">wordsig valE  &#x27;vale&#x27;      # Value computed by ALU</span><br><span class="line">boolsig Cnd &#x27;cond&#x27;      # Branch test</span><br><span class="line"></span><br><span class="line">##### Memory stage computations   #####</span><br><span class="line">wordsig valM  &#x27;valm&#x27;      # Value read from memory</span><br><span class="line">boolsig dmem_error &#x27;dmem_error&#x27;   # Error signal from data memory</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">####################################################################</span><br><span class="line">#    Control Signal Definitions.                                   #</span><br><span class="line">####################################################################</span><br><span class="line"></span><br><span class="line">################ Fetch Stage     ###################################</span><br><span class="line"></span><br><span class="line"># Determine instruction code</span><br><span class="line">word icode = [</span><br><span class="line">  imem_error: INOP;</span><br><span class="line">  1: imem_icode;    # Default: get from instruction memory</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"># Determine instruction function</span><br><span class="line">word ifun = [</span><br><span class="line">  imem_error: FNONE;</span><br><span class="line">  1: imem_ifun;   # Default: get from instruction memory</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">bool instr_valid = icode in </span><br><span class="line">  &#123; INOP, IHALT, IRRMOVQ, IIRMOVQ, IRMMOVQ, IMRMOVQ,</span><br><span class="line">         IOPQ, IJXX, ICALL, IRET, IPUSHQ, IPOPQ, IIADDQ, IJM &#125;;</span><br><span class="line"></span><br><span class="line"># Does fetched instruction require a regid byte?</span><br><span class="line">bool need_regids =</span><br><span class="line">  icode in &#123; IRRMOVQ, IOPQ, IPUSHQ, IPOPQ, </span><br><span class="line">         IIRMOVQ, IRMMOVQ, IMRMOVQ, IIADDQ, IJM &#125;;</span><br><span class="line"></span><br><span class="line"># Does fetched instruction require a constant word?</span><br><span class="line">bool need_valC =</span><br><span class="line">  icode in &#123; IIRMOVQ, IRMMOVQ, IMRMOVQ, IJXX, ICALL, IIADDQ, IJM &#125;;</span><br><span class="line"></span><br><span class="line">################ Decode Stage    ###################################</span><br><span class="line"></span><br><span class="line">## What register should be used as the A source?</span><br><span class="line">word srcA = [</span><br><span class="line">  icode in &#123; IRRMOVQ, IRMMOVQ, IOPQ, IPUSHQ  &#125; : rA;</span><br><span class="line">  icode in &#123; IPOPQ, IRET &#125; : RRSP;</span><br><span class="line">  1 : RNONE; # Don&#x27;t need register</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## What register should be used as the B source?</span><br><span class="line">word srcB = [</span><br><span class="line">  icode in &#123; IOPQ, IRMMOVQ, IMRMOVQ, IIADDQ, IJM  &#125; : rB;</span><br><span class="line">  icode in &#123; IPUSHQ, IPOPQ, ICALL, IRET &#125; : RRSP;</span><br><span class="line">  1 : RNONE;  # Don&#x27;t need register</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## What register should be used as the E destination?</span><br><span class="line">word dstE = [</span><br><span class="line">  icode in &#123; IRRMOVQ &#125; &amp;&amp; Cnd : rB;</span><br><span class="line">  icode in &#123; IIRMOVQ, IOPQ, IIADDQ &#125; : rB;</span><br><span class="line">  icode in &#123; IPUSHQ, IPOPQ, ICALL, IRET &#125; : RRSP;</span><br><span class="line">  1 : RNONE;  # Don&#x27;t write any register</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## What register should be used as the M destination?</span><br><span class="line">word dstM = [</span><br><span class="line">  icode in &#123; IMRMOVQ, IPOPQ &#125; : rA;</span><br><span class="line">  1 : RNONE;  # Don&#x27;t write any register</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">################ Execute Stage   ###################################</span><br><span class="line"></span><br><span class="line">## Select input A to ALU</span><br><span class="line">word aluA = [</span><br><span class="line">  icode in &#123; IRRMOVQ, IOPQ &#125; : valA;</span><br><span class="line">  icode in &#123; IIRMOVQ, IRMMOVQ, IMRMOVQ, IIADDQ, IJM &#125; : valC;</span><br><span class="line">  icode in &#123; ICALL, IPUSHQ &#125; : -8;</span><br><span class="line">  icode in &#123; IRET, IPOPQ &#125; : 8;</span><br><span class="line">  # Other instructions don&#x27;t need ALU</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## Select input B to ALU</span><br><span class="line">word aluB = [</span><br><span class="line">  icode in &#123; IRMMOVQ, IMRMOVQ, IOPQ, ICALL, </span><br><span class="line">          IPUSHQ, IRET, IPOPQ, IIADDQ, IJM &#125; : valB;</span><br><span class="line">  icode in &#123; IRRMOVQ, IIRMOVQ &#125; : 0;</span><br><span class="line">  # Other instructions don&#x27;t need ALU</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## Set the ALU function</span><br><span class="line">word alufun = [</span><br><span class="line">  icode == IOPQ : ifun;</span><br><span class="line">  1 : ALUADD;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## Should the condition codes be updated?</span><br><span class="line">bool set_cc = icode in &#123; IOPQ, IIADDQ &#125;;</span><br><span class="line"></span><br><span class="line">################ Memory Stage    ###################################</span><br><span class="line"></span><br><span class="line">## Set read control signal</span><br><span class="line">bool mem_read = icode in &#123; IMRMOVQ, IPOPQ, IRET, IJM &#125;;</span><br><span class="line"></span><br><span class="line">## Set write control signal</span><br><span class="line">bool mem_write = icode in &#123; IRMMOVQ, IPUSHQ, ICALL &#125;;</span><br><span class="line"></span><br><span class="line">## Select memory address</span><br><span class="line">word mem_addr = [</span><br><span class="line">  icode in &#123; IRMMOVQ, IPUSHQ, ICALL, IMRMOVQ, IJM &#125; : valE;</span><br><span class="line">  icode in &#123; IPOPQ, IRET &#125; : valA;</span><br><span class="line">  # Other instructions don&#x27;t need address</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## Select memory input data</span><br><span class="line">word mem_data = [</span><br><span class="line">  # Value from register</span><br><span class="line">  icode in &#123; IRMMOVQ, IPUSHQ &#125; : valA;</span><br><span class="line">  # Return PC</span><br><span class="line">  icode == ICALL : valP;</span><br><span class="line">  # Default: Don&#x27;t write anything</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">## Determine instruction status</span><br><span class="line">word Stat = [</span><br><span class="line">  imem_error || dmem_error : SADR;</span><br><span class="line">  !instr_valid: SINS;</span><br><span class="line">  icode == IHALT : SHLT;</span><br><span class="line">  1 : SAOK;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">################ Program Counter Update ############################</span><br><span class="line"></span><br><span class="line">## What address should instruction be fetched at</span><br><span class="line"></span><br><span class="line">word new_pc = [</span><br><span class="line">  # Call.  Use instruction constant</span><br><span class="line">  icode == ICALL : valC;</span><br><span class="line">  # Taken branch.  Use instruction constant</span><br><span class="line">  icode == IJXX &amp;&amp; Cnd : valC;</span><br><span class="line">  # Completion of RET instruction.  Use value from stack</span><br><span class="line">  icode == IRET : valM;</span><br><span class="line">  # Use value from memory</span><br><span class="line">  icode == IJM : valM;</span><br><span class="line">  # Default: Use incremented PC</span><br><span class="line">  1 : valP;</span><br><span class="line">];</span><br><span class="line">#/* $end seq-all-hcl */</span><br></pre></td></tr></table></figure>
<h2 id="Part-C">Part C</h2>
<p>这部分是要修改流水线，尽量提高程序的性能。</p>
<p>修改pipe-full.hcl，增加iaddq指令，可以让一些需要两步的命令变成一步。如果修改预测的分支或者让CC在有些时候另作他用可以让程序运行步骤更少，但实践表明不这么操作也能拿到满分。</p>
<p>修改ncopy.ys，采用循环展开，想办法避免load-use冒险。</p>
<p>如此操作可以达到CMU原版lab的满分，但是好像甚至不能达到PKU的及格分，所以需要用一些奇技淫巧来提高性能。最好的方式应当是用树的结构，网络上也有相应的文章讲述如何使用，但是需要略作修改来适配测试。然而我过于菜，没能理解其中的奥妙以及修改的方向，总是越来越垃圾最终放弃。以下是我给出的一种朴素的思路，依然可以获得满分。由于没有什么技巧性以及当时写代码时十分崩溃，我不想做任何解释。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line">#/* $begin ncopy-ys */</span><br><span class="line">##################################################################</span><br><span class="line"># ncopy.ys - Copy a src block of len words to dst.</span><br><span class="line"># Return the number of positive words (&gt;0) contained in src.</span><br><span class="line">#</span><br><span class="line"># name: He Zhuoyuan</span><br><span class="line"># id: 1800013351@pku.edu.cn</span><br><span class="line">#</span><br><span class="line"># Describe how and why you modified the baseline code.</span><br><span class="line"># 1. 增加iaddq指令，使得很多两步指令可以合并为一布</span><br><span class="line"># 2. 一开始的%rax就是0，不需要赋值</span><br><span class="line"># 3. n * 1循环展开，减少循环的次数，减少浪费CPE的跳转指令，同时减少load/use造成的bubble</span><br><span class="line"># 4. 跳转指令是默认taken的，所以要把概率高的下一步语句写在跳转的目标位置</span><br><span class="line"># 5. 处理最后的小于n个元素时，尽量平衡各个情况所需的CPE(参考了三叉树的实现方式)</span><br><span class="line"># 6. 想办法减少len较小的时候的判断用的额外开销，因为此时必要开销仅仅会分摊到很少的几个数，因此对总平均CPE影响很大</span><br><span class="line"># 7. 为了减少代码长度，在处理最后小于n个数的时候想办法复用代码(通过不改变条件码来决定是否跳转，并且此步骤本来应该是bubble，不增加CPE)</span><br><span class="line">##################################################################</span><br><span class="line"># Do not modify this portion</span><br><span class="line"># Function prologue.</span><br><span class="line"># %rdi = src, %rsi = dst, %rdx = len</span><br><span class="line">ncopy:</span><br><span class="line"></span><br><span class="line">##################################################################</span><br><span class="line"># You can modify this portion</span><br><span class="line">    # Loop header</span><br><span class="line">L0:</span><br><span class="line">    iaddq $-10,%rdx </span><br><span class="line">    jl LASTN         # 处理最后小于n个数</span><br><span class="line"></span><br><span class="line">L1:         # 对10个数两个一组处理，避免load/use气泡</span><br><span class="line">    mrmovq (%rdi), %r8</span><br><span class="line">    mrmovq 8(%rdi),%r9</span><br><span class="line">    rmmovq %r8,(%rsi)</span><br><span class="line">    andq %r8, %r8</span><br><span class="line">    jle L2</span><br><span class="line">    iaddq $1,%rax    # if (val &gt; 0) count++</span><br><span class="line">L2: </span><br><span class="line">    rmmovq %r9,8(%rsi)</span><br><span class="line">    andq %r9,%r9</span><br><span class="line">    jle L3</span><br><span class="line">    iaddq $1,%rax</span><br><span class="line">L3:</span><br><span class="line">    mrmovq 16(%rdi), %r8</span><br><span class="line">    mrmovq 24(%rdi), %r9</span><br><span class="line">    rmmovq %r8,16(%rsi)</span><br><span class="line">    andq %r8, %r8</span><br><span class="line">    jle L4</span><br><span class="line">    iaddq $1, %rax      # if (val &gt; 0) count++</span><br><span class="line">L4:</span><br><span class="line">    rmmovq %r9,24(%rsi)</span><br><span class="line">    andq %r9,%r9</span><br><span class="line">    jle L5</span><br><span class="line">    iaddq $1,%rax</span><br><span class="line">L5:</span><br><span class="line">    mrmovq 32(%rdi), %r8</span><br><span class="line">    mrmovq 40(%rdi), %r9</span><br><span class="line">    rmmovq %r8,32(%rsi)</span><br><span class="line">    andq %r8, %r8 </span><br><span class="line">    jle L6</span><br><span class="line">    iaddq $1, %rax      # if (val &gt; 0) count++</span><br><span class="line">L6:</span><br><span class="line">    rmmovq %r9,40(%rsi)</span><br><span class="line">    andq %r9,%r9</span><br><span class="line">    jle L7</span><br><span class="line">    iaddq $1,%rax </span><br><span class="line">L7:</span><br><span class="line">    mrmovq 48(%rdi), %r8</span><br><span class="line">    mrmovq 56(%rdi), %r9</span><br><span class="line">    rmmovq %r8,48(%rsi)</span><br><span class="line">    andq %r8, %r8  </span><br><span class="line">    jle L8</span><br><span class="line">    iaddq $1, %rax      # if (val &gt; 0) count++</span><br><span class="line">L8:</span><br><span class="line">    rmmovq %r9,56(%rsi)</span><br><span class="line">    andq %r9,%r9</span><br><span class="line">    jle L9</span><br><span class="line">    iaddq $1,%rax </span><br><span class="line">L9:</span><br><span class="line">    mrmovq 64(%rdi), %r8</span><br><span class="line">    mrmovq 72(%rdi), %r9</span><br><span class="line">    rmmovq %r8,64(%rsi)</span><br><span class="line">    andq %r8, %r8   </span><br><span class="line">    jle L10</span><br><span class="line">    iaddq $1, %rax        # if (val &gt; 0) count++</span><br><span class="line">L10:</span><br><span class="line">    rmmovq %r9,72(%rsi)</span><br><span class="line">    andq %r9,%r9</span><br><span class="line">    jle L11</span><br><span class="line">    iaddq $1,%rax          # if (val &gt; 0) count++</span><br><span class="line"></span><br><span class="line">L11:                     # next loop preparation</span><br><span class="line">    iaddq $80,%rdi</span><br><span class="line">    iaddq $80,%rsi</span><br><span class="line">    iaddq $-10,%rdx</span><br><span class="line">    jge L1</span><br><span class="line"></span><br><span class="line">LASTN:</span><br><span class="line">    mrmovq (%rdi), %r10</span><br><span class="line">    iaddq $7,%rdx        # 判断剩余的len与3(10-7)的大小关系</span><br><span class="line">    jl  LESS3     # &lt;3</span><br><span class="line">    jg  MORE3        # &gt;3</span><br><span class="line">    je  EQUAL3     # =3</span><br><span class="line"></span><br><span class="line">LESS3:</span><br><span class="line">    iaddq   $2,%rdx      # 10-7-2=1</span><br><span class="line">    je  LAST1_2</span><br><span class="line">    iaddq   $-1,%rdx    # len == 2</span><br><span class="line">    je  LAST2</span><br><span class="line">    ret         # len == 0 </span><br><span class="line">MORE3:</span><br><span class="line">    iaddq   $-3,%rdx    # 10-7+3=6 </span><br><span class="line">    jg  MORE6      #  len &gt; 6</span><br><span class="line">    je  EQUAL6     # len == 6</span><br><span class="line">    iaddq   $1,%rdx </span><br><span class="line">    jl LAST4     # len == 4</span><br><span class="line">    je  LAST5     # len == 5    </span><br><span class="line">MORE6:</span><br><span class="line">    iaddq   $-2,%rdx</span><br><span class="line">    jl  LAST7</span><br><span class="line">    mrmovq 64(%rdi), %r9   # read src[8] from src</span><br><span class="line">    je  LAST8    # len=8</span><br><span class="line"></span><br><span class="line">LAST9:</span><br><span class="line">    rmmovq %r9, 64(%rsi)</span><br><span class="line">    andq %r9, %r9     # set cc</span><br><span class="line"></span><br><span class="line">LAST8:</span><br><span class="line">    mrmovq 56(%rdi), %r8   # read src[7] from src</span><br><span class="line">    jle LAST8_2    </span><br><span class="line">    iaddq $1, %rax        # if(rsi[8]&gt;0) count++</span><br><span class="line">LAST8_2:    </span><br><span class="line">    rmmovq %r8, 56(%rsi)</span><br><span class="line">    andq %r8, %r8     # set cc</span><br><span class="line"></span><br><span class="line">LAST7:</span><br><span class="line">    mrmovq 48(%rdi), %r8   # read src[6] from src</span><br><span class="line">    jle LAST7_2   </span><br><span class="line">    iaddq $1, %rax        # if(rsi[7]&gt;0) count++</span><br><span class="line">LAST7_2:        </span><br><span class="line">    rmmovq %r8, 48(%rsi)</span><br><span class="line">    andq %r8, %r8     # set cc</span><br><span class="line"></span><br><span class="line">EQUAL6:</span><br><span class="line">    mrmovq 40(%rdi), %r8   # read src[5] from src</span><br><span class="line">    jle LAST6_2</span><br><span class="line">    iaddq $1, %rax        # if(rsi[6]&gt;0) count++</span><br><span class="line">LAST6_2:        </span><br><span class="line">    rmmovq %r8, 40(%rsi)</span><br><span class="line">    andq %r8, %r8     # set cc</span><br><span class="line"></span><br><span class="line">LAST5:</span><br><span class="line">    mrmovq 32(%rdi), %r8   # read src[4] from src</span><br><span class="line">    jle LAST5_2   </span><br><span class="line">    iaddq $1, %rax        # if(rsi[5]&gt;0) count++</span><br><span class="line">LAST5_2:</span><br><span class="line">    rmmovq %r8, 32(%rsi)</span><br><span class="line">    andq %r8, %r8     # set cc</span><br><span class="line"></span><br><span class="line">LAST4:</span><br><span class="line">    mrmovq 24(%rdi), %r8   # read src[3] from src</span><br><span class="line">    jle LAST4_2 </span><br><span class="line">    iaddq $1, %rax        # if(rsi[4]&gt;0) count++</span><br><span class="line">LAST4_2:</span><br><span class="line">    rmmovq %r8, 24(%rsi)</span><br><span class="line">    andq %r8, %r8     # set cc</span><br><span class="line"></span><br><span class="line">EQUAL3:</span><br><span class="line">    mrmovq 16(%rdi), %r8   # read src[2] from src</span><br><span class="line">    jle EQUAL3_2   </span><br><span class="line">    iaddq $1, %rax        # if(rsi[3]&gt;0) count++</span><br><span class="line">EQUAL3_2:</span><br><span class="line">    rmmovq %r8, 16(%rsi)</span><br><span class="line">    andq %r8, %r8     # set cc</span><br><span class="line"></span><br><span class="line">LAST2:</span><br><span class="line">    mrmovq 8(%rdi), %r8    # read src[1] from src</span><br><span class="line">    jle LAST2_2   </span><br><span class="line">    iaddq $1, %rax        # if(rsi[2]&gt;0) count++</span><br><span class="line">LAST2_2:</span><br><span class="line">    rmmovq %r8, 8(%rsi)</span><br><span class="line">    andq %r8, %r8 </span><br><span class="line"></span><br><span class="line">LAST1:</span><br><span class="line">    # mrmovq (%rdi), %r8 # read src[0] from src</span><br><span class="line">    jle LAST1_2        # 上一步操作(如果是跳转到这里执行直接跳转，不然判断上一个记录到dst的数是不是正数)</span><br><span class="line">    iaddq $1, %rax        # if(rsi[1]&gt;0) count++</span><br><span class="line">LAST1_2:</span><br><span class="line">    rmmovq %r10, (%rsi)</span><br><span class="line">    andq %r10, %r10</span><br><span class="line">    jle Done </span><br><span class="line">    iaddq $1, %rax        # if(rsi[0]&gt;0) count++</span><br><span class="line"></span><br><span class="line">##################################################################</span><br><span class="line"># Do not modify the following section of code</span><br><span class="line"># Function epilogue.</span><br><span class="line">Done:</span><br><span class="line">    ret</span><br><span class="line">##################################################################</span><br><span class="line"># Keep the following label at the end of your function</span><br><span class="line">End:</span><br><span class="line">#/* $end ncopy-ys */</span><br></pre></td></tr></table></figure>
<hr>
<p>Arch Lab到此就结束了，个人觉得这部分最重要的还是汇编的实现以及流水线的理解，但是对于Part C这样对特殊情况极致性能的追求我是十分厌恶的，毕竟为了寻求这种不通用的方法占用了大量本可以用来理解本质内容（比如说流水线的Bubble是什么冒险怎么解决Forward怎么传）的时间，对于我这种孤身一人奋战的同学来说更是极大的不划算。所以我依然建议对于lab的态度就是理解其中的内涵，而不是创造其中的奥妙。</p>
<p>最后，由于本人在挣扎lab时看完了所有网上能找到的资料，所以参考文献依然是全网2020.10之前的所有相关文章，如有雷同，是我抄袭。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.zhuoyuan-he.cn">Herbert</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.zhuoyuan-he.cn/ICS04-Archlab/">https://blog.zhuoyuan-he.cn/ICS04-Archlab/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.zhuoyuan-he.cn" target="_blank">H's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ICS/">ICS</a></div><div class="post_share"><div class="social-share" data-image="/linear-gradient(20deg,%20#0062be,%20#925696,%20#cc426e,%20#fb0347)" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/ICS05-Shelllab/"><img class="prev-cover" src="/linear-gradient(20deg,%20#0062be,%20#925696,%20#cc426e,%20#fb0347)" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ICS05 Shelllab</div></div></a></div><div class="next-post pull-right"><a href="/ICS02-Bomblab/"><img class="next-cover" src="/linear-gradient(20deg,%20#0062be,%20#925696,%20#cc426e,%20#fb0347)" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ICS02 Bomblab</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/selfie.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Herbert</div><div class="author-info__description">A soul discarded</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/herbyuan"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/herbyuan" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:herbyuan@icloud.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Eventually you come...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-A"><span class="toc-number">1.</span> <span class="toc-text">Part A</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sum-ys"><span class="toc-number">1.1.</span> <span class="toc-text">sum.ys</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsum-ys"><span class="toc-number">1.2.</span> <span class="toc-text">rsum.ys</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bubble-ys"><span class="toc-number">1.3.</span> <span class="toc-text">bubble.ys</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-B"><span class="toc-number">2.</span> <span class="toc-text">Part B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-C"><span class="toc-number">3.</span> <span class="toc-text">Part C</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Windows%E4%B8%8BWebhook%E8%B0%83%E7%94%A8PHP%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%AB%99%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/" title="Windows下Webhook调用PHP实现网站自动部署">Windows下Webhook调用PHP实现网站自动部署</a><time datetime="2023-04-02T13:15:51.000Z" title="发表于 2023-04-02 21:15:51">2023-04-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/hello-world/" title="Hello World">Hello World</a><time datetime="2023-04-02T04:19:43.005Z" title="发表于 2023-04-02 12:19:43">2023-04-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E4%BD%BF%E7%94%A8CloudFlare%E4%BB%A3%E7%90%86%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99/" title="使用CloudFlare代理个人网站">使用CloudFlare代理个人网站</a><time datetime="2023-04-01T13:04:16.000Z" title="发表于 2023-04-01 21:04:16">2023-04-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E5%8D%95%E7%BA%AF%E5%BD%A2%E6%B3%95%E6%B1%82%E8%A7%A3%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/" title="单纯形法求解线性规划">单纯形法求解线性规划</a><time datetime="2023-03-27T15:04:16.000Z" title="发表于 2023-03-27 23:04:16">2023-03-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E6%B1%82%E8%A7%A3%E7%BA%B3%E4%BB%80%E5%9D%87%E8%A1%A1%E7%82%B9/" title="求解纳什均衡点（未完成）">求解纳什均衡点（未完成）</a><time datetime="2023-03-25T15:09:17.000Z" title="发表于 2023-03-25 23:09:17">2023-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Herbert</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>