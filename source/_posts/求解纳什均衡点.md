---
title: 求解纳什均衡点（未完成）
date: 2023-03-25 23:09:17
tags: 博弈论
updated:
type:
comments:
description:
keywords:
top_img:
mathjax:
katex:
aside:
aplayer:
highlight_shrink:
---


# 求解纳什均衡点

## 基本知识回顾

两个人的双矩阵博弈可以这样描述：

两个玩家 M 和 N 各有 m,n 个纯策略，当 M 使用纯策略 i 而 N 使用纯策略 j 时，M 的收益是 $a_{ij}$, N 的收益是 $b_{ij}$. 用 A 和 B 表示由 $a_{ij}$ 和 $b_{ij}$ 构成的矩阵.

M 的混合策略 $x = (x_1,x_2,\cdots,x_m)^T$是指玩家 M 以概率 $x_i$ 使用第 i 个策略，其中 $x_1 + x_2 + \cdots + x_m = 1$, 同理 N 的混合策略是 $y = (y_1,y_2,\cdots,y_n)^T$.

用矩阵的形式，一个混合策略 $(x,y)$ 如下定义：

$$e^T x = e^T y = 1,\text{  and  } x \ge 0, y\ge 0  \tag{2}$$

(策略是单纯形? 这个回头学习一下回来补上)

对应的收益是

$$x^T A y \text{  and  } x^T B y  \tag{3}$$

一个游戏的均衡点 $(x_0,y_0)$ 需要满足对于任意满足 `(2)` 的策略 $(x,y)$, 有

$$x_0^T A y0 \ge x^T A y_0, \text{  and  } x_0^T B y_0 \ge x_0^T B Y \tag{4}$$

纳什证明了平凡的结论：对于 n 个人的有限博弈一定存在均衡点。

## 均衡的等价表述

`(4)` 是说一个策略如果是纳什均衡，则对每个人来说在别人不改变策略的情况下，自己的收益不比采取任何一个策略带来的收益低。另一种等价的表述是：一个策略如果是纳什均衡，则对每个人来说在别人不改变策略的情况下，自己的收益不比采取任何一个自己的纯策略带来的收益低。这一点用期望效用的公式很容易证明。对应的矩阵形式是

$$B^T x_0 \le (x_0^T B y_0)e \text{  and  } Ay_0 \le (x_0^T A y_0)e  \tag{5}$$

也就是说， `(2)(4)` 和 `(2)(5)` 是等价的。

现在令 $E = ee^T$ 是全部元素都是 1 的矩阵, 则满足 `(2)` 的 $(x,y)$ 满足 $Ey = e, x^TEy = x^Te = 1$. 

现在令 $k$ 是一个固定的且足够大的数使得 $kE - B^T > 0, kE - A >0$, 考虑以下方程的解 $(x,y)$ (不需要满足条件`(2)`)

$$
\begin{equation*}
\left\{
    \begin{array}{ll}
        (kE-B^T)x \ge e, x\ge 0, \\
        (kE - A)y \ge e, y\ge 0,
    \end{array}
\right. \text{  and  }
\left\{
    \begin{array}{ll}
        y^T[(kE - B^T)x - e] = 0, \\
        x^T[(kE - A)y - e] = 0.
    \end{array}
\right.
\end{equation*}  \tag{6}
$$

这样的解可以与均衡点 $(x_0,y_0)$ 一一对应. 其实只要把这个方程的解标准化到 $\Sigma x_i = 1, \Sigma y_i = 1$ 即可.

将 $k$ 也看作参数, 约束 `(6)` 的解其实可以看作对 $\Sigma x_i, \Sigma y_i$ 无约束的 `(5)` 的解, 而固定下了 $k$ 二者就构成了一一对应.

展开 `(6)` 的左边两个不等式约束, 得到

$$
\begin{equation*}
\left\{
    \begin{array}{ll}
        B^T x \le k E x - e, \\
        Ay \le k E y - e.
    \end{array}
\right.
\end{equation*}
$$

$y$ 和 $(kE - B^T)x - e$ 都是大于等于 0 的向量, 它们的内积为零说明在任意一个维度上至多只能有一个向量为正, 且两个向量都存在一些维度为零.

$k E x - e$ 是所有元素都为 $k\Sigma x_i - 1$ 的列向量, $(kE - B^T)x - e \ge 0$ 且有些元素严格取等说明 $k\Sigma x_i - 1 = \max B^Tx$, $y$ 只能在 $B^T x$ 中等于 $\max B^Tx$ 的维度上大于零, 这其实对应于均衡时每个人策略的支撑集应当包含于对其他人策略的最优反应($\text{supp}(\sigma_i) \subset BR_i(\sigma_{-i})$). 这里已经给出了均衡时各个策略之间分布的比例关系, 将 $(x,y)$ 标准化到 $\Sigma x_i = 1, \Sigma y_i = 1$ 即可得到一个均衡点.

展开 `(6)` 的右边两个等式约束, 得到

$$
\begin{equation*}
\left\{
    \begin{array}{ll}
        k y^TE x - y^Te = y^TB^Tx, \\
        k x^T E y - x^Te = x^TAy.
    \end{array}
\right.
\end{equation*}
$$

注意到 $y^TE x = x^T E y = (\Sigma x_i)(\Sigma y_j)$, 想从 $(x_0,y_0)$ 映射到 $(x,y)$, 其实也是要确定缩放的比例 $r_1,r_2$, 记均衡收益为 $(p_1,p_2)$, 求解方程组

$$
\begin{equation*}
\left\{
    \begin{array}{ll}
        k r_1 r_2 - r_2 = r_1 r_2 p_2, \\
        k r_1 r_2 - r_1 = r_1 r_2 p_1.
    \end{array}
\right.
\end{equation*}
$$

对应的$(x,y) = (r_1 x_0, r_2 y_0)$.

## 非退化问题

上一节已经证明了 `(2)(5)` 与 `(2)(6)` 的等价性, 接下来只要考虑以下问题的解: A 和 B 的矩阵元素都为正数, 求解 $(x,y)$ 满足

$$
\begin{equation*}
\left\{
    \begin{array}{ll}
        B^Tx \ge e, x\ge 0, \\
        Ay \ge e, y\ge 0,
    \end{array}
\right. \text{  and  }
\left\{
    \begin{array}{ll}
        y^T(B^Tx - e) = 0, \\
        x^T(Ay - e) = 0.
    \end{array}
\right.
\end{equation*}  \tag{7}
$$

> 这里的 $A,B$ 对应于上一节中的 $kE - B^T$ 和 $kE - A$.

令

$$X = \{x:x \ge 0, B^Tx - e \ge 0\}$$

记

$$B = (b_1,b_2,\cdots,b_n), I = (e_1,e_2,\cdots,e_m)$$

$X$ 是满足 $m+n$ 个不等式约束的 $x$ 的集合

$$
\begin{align*}
	&e_i^T x \ge 0, & i = 1,2,\cdots,m,\\
    &b_j^T x - 1 \ge 0, & j = 1,2,\cdots,n.
\end{align*}
\tag{10}
$$

X 边界上的点是 X 中满足以下至少一个线性关系的x

$$
\begin{align*}
	&e_i^T x = 0, & i = 1,2,\cdots,m,\\
    &b_j^T x - 1 = 0, & j = 1,2,\cdots,n.
\end{align*}
\tag{10}
$$

对于任意的 x, 对应了一个由$(B,I)$ 的若干列向量构成的矩阵$M(x)$: $b_j$(或者$e_i$)是 M 中的列向量当且仅当 $b_j^T x - 1 = 0$(或者$e_i^Tx = 0$). M(x) 中列向量的顺序并不重要.

若 $\bar B = (B,I)$ 的秩为 $m$, 至多存在一个 $x$ 使得 $\bar B = M(x)$. 如果更进一步, $x\in X$, 这就是 X 的一个极端点($extreme\ point$). **即使不是计算上的需要，也是非常方便的，在下面的内容中要确保对于一个极端点x，M(x)正好有m列。接下来我们假设 X 满足非退化假设:**

$\bar B = (B,I)$ 是 m 行 r 列的矩阵.如果存在 x 使得 $\bar B = M(x)$, 则 $rank(B) = r$.

-------

**扰动定义一个给定的凸多面体（如X）的数据，从而使扰动的数据定义一个非退化多面体的方法，是众所周知的。**

**对于给定的凸多面体 X，可以通过多种方式扰动定义该多面体的数据，使得扰动后的数据定义一个非退化的多面体**

这种扰动并不会影响存在性的证明,而是简化了均衡点的计算.这里指出一些这种假设的相关影响.

-------

令 $x_0$ 是 X 中的一个点, $M(x_0)$ 是 $m\times r$ 的矩阵. 由非退化假设, $rank(M(x_0)) = r$, 所以 $M(x_0)$ 的列向量线性无关. 把 $M(x_0)$ 写作 $(d_1, d_2, \cdots, d_r)$, 可以扩充成m个线性无关的向量 $C = (d_1, d_2, \cdots, d_m)$, 记 C 的逆矩阵的转置为 $C^{-T} = (d^1, d^2, \cdots, d^m)$, 则有性质

$$d_i^Td^j = \delta_i^j$$

> $\delta_i^j$ 是克罗内克尔符号(Kronecker symbol), 当 $i = j$ 时, $\delta_i^j=1$, 当 $i \neq j$ 时, $\delta_i^j=0$.

考虑从 $x_0$ 变化得到的点

$$x = x_0 + \Sigma_{i = 1}^m t_i d^i,  \tag{12}$$

其中 $t_i$ 是标量.

则有以下引理:

- 存在 k 使得 $\Sigma t_i^2 \le k$ 且 $t_i \ge 0$ 时, `(12)` 给出的点都在 X 中.

> 考虑直接把 x 代入约束条件记得到证明.

这个引理主要是由于非退化性假设, 由此可得:

- (i) 如果 $x_0$ 是 X 的一个极限点, 所以 $M(x_0)$ **(此处论文好像有typo)** 是非奇异的. $t_i$ 非负且很小的情形下 $x = x_0 + t_i d^i$ 得到的 x 都在 X 中, $M(x) = M_i$ 是从 $M(x_0)$ 中删除第 i 列得到的矩阵. 这些点构成的集合叫做 **X 的端点为 $x_0$ 的一条开边(open edge)**.

- (ii) 如果 $x_0$ 是 X 中满足 $rank(M(x_0)) = m - 1$ 的点, 由 `(12)` 可得, $x = x_0 + t_m d^m \quad (|t_m \le k|)$ 对一些 k 满足 $M(x) = M(x_0)$. 这些点构成的集合被定义为 **X 的一条开边(open edge)**. 所以对于任意的 x, x 附近的点仅能满足和 x 一样的线性约束条件(约束 `(11)`). 因此, **恰好有 m 条开边其中一个端点是极端点**.

- (iii) X 恰好有 m 条无限边(unbounded edges), 每条边只有一个端点. 这些边上的点有性质 $x = ke_i$, 其中 k 是足够大的正数. 这是由于 B 只有正的元素, 其他 X 的开边都有两个端点, 即连接两个极端点. 因此, **两个极端点是相邻的当且仅当他们对应的矩阵有且仅有一列不相同(列的顺序并不重要)**.

类似地, 令

$$Y = \{y:y \ge 0, Ay - e \ge 0\}. \tag{14}$$

Y 的边界定义为 Y 中满足至少一条以下条件的点:

$$
\begin{align*}
    &a_i^T y - 1 = 0, & i = 1,2,\cdots,m,\\
    &e_j^T y = 0, & j = 1,2,\cdots,n.
\end{align*}
\tag{10}
$$

其中 $A^T = (a_1, a_2, \cdots, a_m)$.

和 X 一样, 假设 Y 满足非退化条件, 所有的定义和引理都类似, 只是 m 和 n 互换了, $(B,I)$ 换成了 $(I, A^T)$, N(y) 表示对应的矩阵.

令 $Z = (X,Y)$ 是 X 和 Y 的笛卡尔积. $z = (x,y)$ 是 Z 的极端点当且仅当 x 是 X 的极端点且 y 是 Y 的极端点. z 在 Z 的一条开边上当且仅当 x 和 y 其中一个是极端点, 另一个在开边上.

由 `(7)`, 均衡点 $z = (x,y)$ 的均衡条件是 Z 中的点 z 满足非退化假设

$$
\begin{align*}
    &(e_i^T x)(a_i^T y - 1), & i = 1,2,\cdots,m,\\
    &(e_j^T y)(b_j^T x -1), & j = 1,2,\cdots,n.
\end{align*}
\tag{10}
$$

- 引理: 非退化问题的均衡点是 Z 的极端点.

对于给定的 r, 定义 $S_r$ 是 Z 中满足所有 m+n 个约束中除了可能违背 $(e_r^T y)(b_r^T x - 1) = 0$, 其他都满足的点的集合.

- 引理: $S_r$ 中的点要么是 Z 的极端点, 要么在 Z 的开边上.

- 引理: 恰有一个 Z 的无限边由 $S_r$ 的点构成.

- 引理: z 是 Z 的一个极端点, 也是 $S_r$ 中的点. 存在 Z 的一到两条开边构成了所有 $S_r$ 中的点, 且一个端点是 z. **z 是一个均衡点当且仅当存在一条这样的边**.

- 引理: $S_r$ 是非空的. 且 $S_r$ 是有限个不相交的 r-路径的并集。每个 r-路径要么是闭合的r-路径（不含均衡点），要么包含一个或两个均衡点。

现在令 $P_0$ 是包含无限边 $E_0$ 的r-路径.

**定理: $P_0$ 包含恰好一个均衡点. 这个点的计算可以通过从无限边 $E_0$ 开始遍历 $P_0$ 得到. 均衡点的数量一定是有限的且为奇数.**


### 一般情形(解决退化问题)

- (i) 原始的数据可以通过类似线性规划理论的扰动得到非退化问题, 且通过上一节的结论依然有效;
- (ii) 扰动方案确保扰动后的多面体的任何极端点都定义了原始多面体的一个明确的极端点.特别地，扰动问题的均衡点定义了原始问题的均衡点。特定的扰动方案不是唯一的。**使用扰动数据计算极点路径的计算方案是众所周知的，本文不再讨论。**


